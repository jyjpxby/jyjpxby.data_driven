Reaction Path Simulation Code Guidelines

The codes are divided into three parts according to the simulation principles: (1) simulation of the effect of surface adsorption on the reaction trends; (2) simulation of the catalytic reaction process of non-migratory active sites; (3) simulation of the catalytic reaction process of migratory active sites. For the reaction path simulation occurred in one catalytic active site, the non-migratory active site path simulation code is used. For the reaction path simulation occurred in the collaboration of multiple catalytic active sites, the migratory active site path simulation code is used. After downloading all the codes, you only need to modify the calculation parameters and simulation data in the excel sheet and run the program to complete the simulation without modifying the codes. All codes can be run directly in MATLAB R2022a and above.

1.	Simulation of the effect of surface adsorption on the reaction trends
(1) Calculate the interaction energy between the catalyst surface and the substrate using simulation software, e.g., Materials Studio or VASP. 
(2) Record the interaction energies (referred to as surface adsorption energies) over a period of time (e.g., 500 ps, with every 5 ps as an interval). 
(3) Fill in the table according to the preset format of the table adsorb.xlsx (Note: you can fill in several different surface adsorption energies at one time).
(4) Fill in the first six lines with the number of the substrate included in the mixed substrate, substrate number (Note: the program allows a maximum of three substrates to be mixed; if the solvent is not involved in the reaction, the solvent number can be left out), and substrate mixing ratio (Note: it can be the ratio of the molar amounts of a substance or the molar percentage of substances in the system).
(5) Put the files ads_Settings.xlsx, adsorb.xlsx, checkPath3.m, dist_3d.m, main_RRTads.m, and steer3d.m in the same folder. Then, set up the simulation parameters in table ads_Settings.xlsx, including the table where the simulated data are located. Set the simulation parameters in table ads_Settings.xlsx, including sheet_number, number_of_substrate, confidence_region, EPS, numNodes, no. 1 substance_proportion, no. 2 substance_proportion, and no. 3 substance_proportion, and the name of the simulation data file (adsorb_filename) (Note: the step precision can be selected from 0.01 to 0.65; the smaller the value, the higher the accuracy, but the longer the calculation time; the larger the value of the simulation node, the closer the result is to the real value, but the longer the calculation time.).
(6) After setting the parameters, save the file, open the main_RRTads.m file, and click the RUN button, you can wait for the simulation path to finish drawing.
(7) In the resultant figures, the products are distributed around the simulated light cone according to the previously set numbers (Note: the colors of the background in the figure represent the surface adsorption energies between the catalyst and the substrate or the products under different reaction conditions; different sectors in the figure represent different combinations of products; black lines represent the possible reaction paths, which start from the center of the simulated light cone and extend to the products around it, representing the change of the catalytic reaction process from substrates to products).

2.	Simulation of the catalytic reaction process of non-migratory active sites 
(1) Put the files main_Reaction_energy.m, reaction.xlsx and reaction_Setting.xlsx in the same folder. 
(2) Calculate the energies of the chemical bond between the active site and each substrate at the time of the reaction, fill in the table reaction.xlsx (Note: you can fill in the energies of the chemical bond between more than one active site and substrate at a time), and save it. 
(3) Set the parameters of the simulation calculation in reaction_Setting.xlsx, including the number of substrate species (Total_number_of_product_species), simulation data in reaction_Setting.xlsx. Set the simulation parameters, including the number of substrate species (Total_number_of_product_species), the page number of the table where the simulation data is located (sheet_number), the number of substrate (Number_of_substrate), and the name of the simulation data file (reaction_filename), and save it.
(4) Open the main_Reaction_energy.m, and click on the RUN button. Then, wait for the program to finish.
(5) The simulation results are shown in two diagrams. The first one is the 3D diagram of the simulated light cone. The second one is the XY plane projection of the simulated light cone. The analysis results are based on the second diagram (Note: the colors of the background in the figure represent the chemical energy between the catalyst and the substrate or product; the products are distributed around the simulated light cone according to the number set before; the numbers on the inside of the simulated light cone represent the positive and negative average chemical energy within the sector and the order of magnitude; the smaller the number the lower the chemical energy; red numbers represent a negative chemical energy; black numbers represent a zero or positive chemical energy).

3.	Simulation of the catalytic reaction process of migratory active sites
(1) Put the folders Paths, Paths and Nodes, Path_Matrix.txt, Enthalpy_path_matrix.txt, Adsorption_path_matrix.txt,main_DIJKSTRA_QM_MM.m, main_Path_Matrix.m, and path_simulation_setting.xlsx in the same folder as the Records.txt file.
(2) Calculate the energies of the chemical bond between the active site and each substrate at the time of the reaction and the adsorption energy between the individual substrate and each active site if no bond is formed, and fill in the table path_simulation_setting.xlsx. 
(3) Set the calculation parameters in the table path_simulation_setting.xlsx, including the number of active site species (Active_site_species_quantity), the limits of the difference in chemical energies during active site migration (Δ_chemistry_min and Δ_chemistry_max), limit of adsorption energy difference during migration of active site (Δ_adsorb_min and Δ_adsorb_max), the name of the binding of the active site to the substrate (Active_site_name), Adsorption_energy (eV), and chemical_energy (eV).
(4) Artificially excluded impossible catalytic reaction path (Removed_paths_start and Removed_paths_end) and the paths (Record_Nodes_start and Record_Nodes_end) that are prepared to record the sum of the elementary reaction energies, and save the file after recording.
(5) Open the main_Path_Matrix.m file and run the program directly to get the sum of the elementary reaction energies corresponding to the adsorption path (Adsorption_path_matrix.txt), the sum of the elementary reaction energies corresponding to the chemical reaction (Enthalpy_path_matrix.txt), and the sum of the elementary reaction energies of the path after the combined analysis (Path_ Matrix.txt). 
(6) Open the main_DIJKSTRA_QM_MM.m file and click the RUN button to wait for all possible reaction paths to be plotted and saved into the folder: Paths and the folder: Paths and Nodes, and the preset recorded paths and the sum of the elementary reaction energies of the paths will be automatically recorded in the Records.txt file.
(7) The simulation results are saved in two folders. The specific analysis results are based on the contents of the Paths and Nodes folder. The file numbering is in the format of “substrate number - product number”. The two sides of the figure are the intermediate states corresponding to the start state and the result state (Note: the line between them represents the step-by-step paths involved in the path of the minimum energy of the reaction; all possible reaction paths (marked in red and black) and the path with the lowest catalytic reaction energy (marked in red) are shown in the middle of the figure).

